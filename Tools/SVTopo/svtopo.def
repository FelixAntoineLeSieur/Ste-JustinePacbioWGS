Bootstrap: docker
From: python:3.11-slim

%files
	svtopo_requirements.txt /app/svtopo_requirements.txt

%post
	apt-get update && apt-get install git -y && apt-get clean autoclean \
		&& apt-get install -y wget
	python -m venv /app/venv
	cd /app
	wget https://github.com/PacificBiosciences/SVTopo/releases/download/v0.3.0/svtopo-v0.3.0-x86_64-unknown-linux-gnu.tar.gz
	tar -xvzf svtopo-v0.3.0-x86_64-unknown-linux-gnu.tar.gz
	mv svtopo-v0.3.0-x86_64-unknown-linux-gnu/svtopo /app/venv/bin/
	rm svtopo-v0.3.0-x86_64-unknown-linux-gnu.tar.gz
	git clone --branch v0.3.0 https://github.com/PacificBiosciences/SVTopo.git
	/app/venv/bin/pip install --no-index --upgrade pip
	/app/venv/bin/pip install --no-cache-dir -r svtopo_requirements.txt
	wget -O "SVTopo/cnv.excluded_regions.hg38.bed.gz" https://github.com/PacificBiosciences/HiFiCNV/raw/refs/heads/main/data/excluded_regions/cnv.excluded_regions.hg38.bed.gz
	

%environment
  export PATH=/app/venv/bin:$PATH